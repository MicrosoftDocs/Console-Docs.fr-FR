---
title: Mémoire tampon d’entrée d’une console
description: Chaque console possède une mémoire tampon d’entrée qui contient une file d’attente d’enregistrements d’événements d’entrée.
author: miniksa
ms.author: miniksa
ms.topic: conceptual
keywords: console, applications en mode caractère, applications en ligne de commande, applications de terminal, API console
MS-HAID:
- '\_win32\_console\_input\_buffer'
- base.console\_input\_buffer
- consoles.console\_input\_buffer
MSHAttr:
- PreferredSiteName:MSDN
- PreferredLib:/library/windows/desktop
ms.assetid: 6e536658-8a27-478e-82ee-d1e11f351301
ms.openlocfilehash: 9b210e07fd2531b2f58130f4b96ad31a374923f4
ms.sourcegitcommit: 463975e71920908a6bff9a6a7291ddf3736652d5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/30/2020
ms.locfileid: "93039207"
---
# <a name="console-input-buffer"></a><span data-ttu-id="1a417-104">Mémoire tampon d’entrée d’une console</span><span class="sxs-lookup"><span data-stu-id="1a417-104">Console Input Buffer</span></span>

<span data-ttu-id="1a417-105">Chaque console possède une mémoire tampon d’entrée qui contient une file d’attente d’enregistrements d’événements d’entrée.</span><span class="sxs-lookup"><span data-stu-id="1a417-105">Each console has an input buffer that contains a queue of input event records.</span></span> <span data-ttu-id="1a417-106">Lorsque la fenêtre d’une console a le focus clavier, une console met en forme chaque événement d’entrée (par exemple, une frappe de touche, un mouvement de la souris ou un clic sur le bouton de la souris) comme un enregistrement d’entrée qu’il place dans la mémoire tampon d’entrée de la console.</span><span class="sxs-lookup"><span data-stu-id="1a417-106">When a console's window has the keyboard focus, a console formats each input event (such as a single keystroke, a movement of the mouse, or a mouse-button click) as an input record that it places in the console's input buffer.</span></span>

<span data-ttu-id="1a417-107">Les applications peuvent accéder indirectement à la mémoire tampon d’entrée d’une console à l’aide des [fonctions d’e/s de console de haut niveau](high-level-console-input-and-output-functions.md), ou directement à l’aide des [fonctions d’entrée de la console de bas niveau](low-level-console-input-functions.md).</span><span class="sxs-lookup"><span data-stu-id="1a417-107">Applications can access a console's input buffer indirectly by using the [high-level console I/O functions](high-level-console-input-and-output-functions.md), or directly by using the [low-level console input functions](low-level-console-input-functions.md).</span></span> <span data-ttu-id="1a417-108">Les fonctions d’entrée de haut niveau filtrent et traitent les données dans la mémoire tampon d’entrée, en retournant uniquement un flux de caractères d’entrée.</span><span class="sxs-lookup"><span data-stu-id="1a417-108">The high-level input functions filter and process the data in the input buffer, returning only a stream of input characters.</span></span> <span data-ttu-id="1a417-109">Les fonctions d’entrée de bas niveau permettent aux applications de lire des enregistrements d’entrée directement à partir de la mémoire tampon d’entrée d’une console, ou de placer des enregistrements d’entrée dans la mémoire tampon d’entrée.</span><span class="sxs-lookup"><span data-stu-id="1a417-109">The low-level input functions enable applications to read input records directly from a console's input buffer, or to place input records into the input buffer.</span></span> <span data-ttu-id="1a417-110">Pour ouvrir un handle vers la mémoire tampon d’entrée d’une console, spécifiez la valeur **CONIN $** dans un appel à la fonction [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858) .</span><span class="sxs-lookup"><span data-stu-id="1a417-110">To open a handle to a console's input buffer, specify the **CONIN$** value in a call to the [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858) function.</span></span>

<span data-ttu-id="1a417-111">Un enregistrement d’entrée est une structure contenant des informations sur le type d’événement qui s’est produit (clavier, souris, redimensionnement de fenêtre, focus ou événement de menu), ainsi que des détails spécifiques sur l’événement.</span><span class="sxs-lookup"><span data-stu-id="1a417-111">An input record is a structure containing information about the type of event that occurred (keyboard, mouse, window resizing, focus, or menu event) as well as specific details about the event.</span></span> <span data-ttu-id="1a417-112">Le membre **eventType** dans une structure [**d' \_ enregistrement d’entrée**](input-record-str.md) indique quel type d’événement est contenu dans l’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="1a417-112">The **EventType** member in an [**INPUT\_RECORD**](input-record-str.md) structure indicates which type of event is contained in the record.</span></span>

<span data-ttu-id="1a417-113">Les événements de focus et de menu sont placés dans la mémoire tampon d’entrée d’une console pour une utilisation interne par le système et doivent être ignorés par les applications.</span><span class="sxs-lookup"><span data-stu-id="1a417-113">Focus and menu events are placed in a console's input buffer for internal use by the system and should be ignored by applications.</span></span>

## <a name="keyboard-events"></a><span data-ttu-id="1a417-114">Événements de clavier</span><span class="sxs-lookup"><span data-stu-id="1a417-114">Keyboard Events</span></span>

<span data-ttu-id="1a417-115">Les événements de clavier sont générés lorsqu’une touche est enfoncée ou libérée. Cela comprend les clés de contrôle.</span><span class="sxs-lookup"><span data-stu-id="1a417-115">Keyboard events are generated when any key is pressed or released; this includes control keys.</span></span> <span data-ttu-id="1a417-116">Toutefois, la touche ALT a une signification particulière pour le système lorsqu’elle est appuyée et libérée sans être associée à un autre caractère, et elle n’est pas transmise à l’application.</span><span class="sxs-lookup"><span data-stu-id="1a417-116">However, the ALT key has special meaning to the system when pressed and released without being combined with another character, and it is not passed through to the application.</span></span> <span data-ttu-id="1a417-117">En outre, la combinaison de touches CTRL + C n’est pas transmise si le handle d’entrée est en mode traité.</span><span class="sxs-lookup"><span data-stu-id="1a417-117">Also, the CTRL+C key combination is not passed through if the input handle is in processed mode.</span></span>

<span data-ttu-id="1a417-118">Si l’événement d’entrée est une séquence de touches, le membre d' **événement** dans l' [**\_ enregistrement d’entrée**](input-record-str.md) est une structure d' [**\_ \_ enregistrement d’événement clé**](key-event-record-str.md) contenant les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="1a417-118">If the input event is a keystroke, the **Event** member in [**INPUT\_RECORD**](input-record-str.md) is a [**KEY\_EVENT\_RECORD**](key-event-record-str.md) structure containing the following information:</span></span>

- <span data-ttu-id="1a417-119">Valeur booléenne indiquant si la touche a été enfoncée ou libérée.</span><span class="sxs-lookup"><span data-stu-id="1a417-119">A Boolean value indicating whether the key was pressed or released.</span></span>
- <span data-ttu-id="1a417-120">Nombre de répétitions qui peut être supérieur à un lorsqu’une touche est maintenue enfoncée.</span><span class="sxs-lookup"><span data-stu-id="1a417-120">A repeat count that can be greater than one when a key is held down.</span></span>
- <span data-ttu-id="1a417-121">Code de la touche virtuelle, identifiant la clé donnée de façon indépendante du périphérique.</span><span class="sxs-lookup"><span data-stu-id="1a417-121">The virtual-key code, identifying the given key in a device-independent manner.</span></span>
- <span data-ttu-id="1a417-122">Code d’analyse virtuelle, indiquant la valeur dépendante du périphérique générée par le matériel clavier.</span><span class="sxs-lookup"><span data-stu-id="1a417-122">The virtual-scan code, indicating the device-dependent value generated by the keyboard hardware.</span></span>
- <span data-ttu-id="1a417-123">™ Unicode ou caractère ANSI traduit.</span><span class="sxs-lookup"><span data-stu-id="1a417-123">The translated Unicode™ or ANSI character.</span></span>
- <span data-ttu-id="1a417-124">Variable d’indicateur qui indique l’état des touches de contrôle (ALT, CTRL, Maj, Verr. NUM, verrou de défilement et touches de verrouillage en MAJUSCULEs) et indique si une touche améliorée a été enfoncée.</span><span class="sxs-lookup"><span data-stu-id="1a417-124">A flag variable indicating the state of the control keys (the ALT, CTRL, SHIFT, NUM LOCK, SCROLL LOCK, and CAPS LOCK keys) and indicating whether an enhanced key was pressed.</span></span> <span data-ttu-id="1a417-125">Les clés améliorées pour les claviers IBM® 101-Key et 102-Key sont les touches Inser, DEL, début, fin, PAGE précédente, PAGE suivante et flèche dans les clusters à gauche du pavé numérique et les touches Division (/) et entrée du pavé numérique.</span><span class="sxs-lookup"><span data-stu-id="1a417-125">Enhanced keys for the IBM® 101-key and 102-key keyboards are the INS, DEL, HOME, END, PAGE UP, PAGE DOWN, and arrow keys in the clusters to the left of the numeric keypad and the divide (/) and ENTER keys in the numeric keypad.</span></span>

## <a name="mouse-events"></a><span data-ttu-id="1a417-126">Événements de souris</span><span class="sxs-lookup"><span data-stu-id="1a417-126">Mouse Events</span></span>

<span data-ttu-id="1a417-127">Les événements de souris sont générés lorsque l’utilisateur déplace la souris ou appuie sur ou relâche l’un des boutons de la souris.</span><span class="sxs-lookup"><span data-stu-id="1a417-127">Mouse events are generated whenever the user moves the mouse or presses or releases one of the mouse buttons.</span></span> <span data-ttu-id="1a417-128">Les événements de souris ne sont placés dans la mémoire tampon d’entrée que si les conditions suivantes sont remplies :</span><span class="sxs-lookup"><span data-stu-id="1a417-128">Mouse events are placed in the input buffer only if the following conditions are met:</span></span>

- <span data-ttu-id="1a417-129">Le mode d’entrée de la console est défini pour **activer l' \_ \_ entrée de la souris** (mode par défaut).</span><span class="sxs-lookup"><span data-stu-id="1a417-129">The console input mode is set to **ENABLE\_MOUSE\_INPUT** (the default mode).</span></span>
- <span data-ttu-id="1a417-130">La fenêtre de console a le focus clavier.</span><span class="sxs-lookup"><span data-stu-id="1a417-130">The console window has the keyboard focus.</span></span>
- <span data-ttu-id="1a417-131">Le pointeur de la souris se trouve dans les limites de la fenêtre de la console.</span><span class="sxs-lookup"><span data-stu-id="1a417-131">The mouse pointer is within the borders of the console's window.</span></span>

<span data-ttu-id="1a417-132">Si l’événement d’entrée est un événement de souris, le membre d' **événement** dans l' [**\_ enregistrement d’entrée**](input-record-str.md) est une structure d' [**enregistrement d' \_ événement \_ de souris**](mouse-event-record-str.md) contenant les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="1a417-132">If the input event is a mouse event, the **Event** member in [**INPUT\_RECORD**](input-record-str.md) is a [**MOUSE\_EVENT\_RECORD**](mouse-event-record-str.md) structure containing the following information:</span></span>

- <span data-ttu-id="1a417-133">Coordonnées du pointeur de la souris en termes de la ligne et de la colonne de cellule de caractère dans le système de coordonnées de la mémoire tampon de l’écran de la console.</span><span class="sxs-lookup"><span data-stu-id="1a417-133">The coordinates of the mouse pointer in terms of the character-cell row and column in the console screen buffer's coordinate system.</span></span>
- <span data-ttu-id="1a417-134">Variable d’indicateur qui indique l’état des boutons de la souris.</span><span class="sxs-lookup"><span data-stu-id="1a417-134">A flag variable indicating the state of the mouse buttons.</span></span>
- <span data-ttu-id="1a417-135">Variable d’indicateur qui indique l’état des touches de contrôle (ALT, CTRL, Maj, Verr. NUM, verrou de défilement et Verr. Maj) et indique si une touche améliorée a été enfoncée.</span><span class="sxs-lookup"><span data-stu-id="1a417-135">A flag variable indicating the state of the control keys (ALT, CTRL, SHIFT, NUM LOCK, SCROLL LOCK, and CAPS LOCK) and indicating whether an enhanced key was pressed.</span></span> <span data-ttu-id="1a417-136">Les clés améliorées pour les claviers IBM 101-Key et 102-Key sont les touches Inser, DEL, début, fin, PAGE précédente, PAGE suivante et flèche dans les clusters à gauche du pavé numérique et les touches de division (/) et de saisie dans le pavé numérique.</span><span class="sxs-lookup"><span data-stu-id="1a417-136">Enhanced keys for the IBM 101-key and 102-key keyboards are the INS, DEL, HOME, END, PAGE UP, PAGE DOWN, and arrow keys in the clusters to the left of the numeric keypad and the divide (/) and ENTER keys in the numeric keypad.</span></span>
- <span data-ttu-id="1a417-137">Variable d’indicateur qui indique si l’événement est un événement de bouton ou de libération de bouton normal, un événement de déplacement de la souris ou un deuxième clic sur un événement de double-clic.</span><span class="sxs-lookup"><span data-stu-id="1a417-137">A flag variable indicating whether the event was a normal button-press or button-release event, a mouse movement event, or the second click of a double-click event.</span></span>

> [!NOTE]
><span data-ttu-id="1a417-138">Les coordonnées de position de la souris sont en termes de mémoire tampon d’écran de la console, et non de la fenêtre de console.</span><span class="sxs-lookup"><span data-stu-id="1a417-138">The mouse position coordinates are in terms of the console screen buffer, not the console window.</span></span> <span data-ttu-id="1a417-139">La mémoire tampon d’écran a peut-être été défilée par rapport à la fenêtre. par conséquent, le coin supérieur gauche de la fenêtre n’est pas nécessairement la coordonnée (0,0) de la mémoire tampon d’écran de la console.</span><span class="sxs-lookup"><span data-stu-id="1a417-139">The screen buffer may have been scrolled with respect to the window, so the upper left corner of the window is not necessarily the (0,0) coordinate of the console screen buffer.</span></span> <span data-ttu-id="1a417-140">Pour déterminer les coordonnées de la souris par rapport au système de coordonnées de la fenêtre, soustraire les coordonnées d’origine de la fenêtre des coordonnées de position de la souris.</span><span class="sxs-lookup"><span data-stu-id="1a417-140">To determine the coordinates of the mouse relative to the coordinate system of the window, subtract the window origin coordinates from the mouse position coordinates.</span></span> <span data-ttu-id="1a417-141">Utilisez la fonction [**GetConsoleScreenBufferInfo**](getconsolescreenbufferinfo.md) pour déterminer les coordonnées d’origine de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="1a417-141">Use the [**GetConsoleScreenBufferInfo**](getconsolescreenbufferinfo.md) function to determine the window origin coordinates.</span></span>

<span data-ttu-id="1a417-142">Le membre **dwButtonState** de la structure de l’enregistrement de l' [**\_ événement \_ de souris**](mouse-event-record-str.md) a un bit correspondant à chaque bouton de la souris.</span><span class="sxs-lookup"><span data-stu-id="1a417-142">The **dwButtonState** member of the [**MOUSE\_EVENT\_RECORD**](mouse-event-record-str.md) structure has a bit corresponding to each mouse button.</span></span> <span data-ttu-id="1a417-143">Le bit est 1 si le bouton est enfoncé et 0 si le bouton est actif.</span><span class="sxs-lookup"><span data-stu-id="1a417-143">The bit is 1 if the button is down and 0 if the button is up.</span></span> <span data-ttu-id="1a417-144">Un événement de libération de bouton est détecté par une valeur 0 pour le membre **dwEventFlags** de l' **enregistrement d' \_ événement \_ de souris** et une modification du bit d’un bouton de 1 à 0.</span><span class="sxs-lookup"><span data-stu-id="1a417-144">A button-release event is detected by a 0 value for the **dwEventFlags** member of **MOUSE\_EVENT\_RECORD** and a change in a button's bit from 1 to 0.</span></span> <span data-ttu-id="1a417-145">La fonction [**GetNumberOfConsoleMouseButtons**](getnumberofconsolemousebuttons.md) récupère le nombre de boutons sur la souris.</span><span class="sxs-lookup"><span data-stu-id="1a417-145">The [**GetNumberOfConsoleMouseButtons**](getnumberofconsolemousebuttons.md) function retrieves the number of buttons on the mouse.</span></span>

## <a name="buffer-resizing-events"></a><span data-ttu-id="1a417-146">Événements de Buffer-Resizing</span><span class="sxs-lookup"><span data-stu-id="1a417-146">Buffer-Resizing Events</span></span>

<span data-ttu-id="1a417-147">Le menu d’une fenêtre de console permet à l’utilisateur de modifier la taille de la mémoire tampon d’écran active ; Cette modification génère un événement de redimensionnement de mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="1a417-147">A console window's menu enables the user to change the size of the active screen buffer; this change generates a buffer-resizing event.</span></span> <span data-ttu-id="1a417-148">Les événements de redimensionnement de mémoire tampon sont placés dans la mémoire tampon d’entrée si le mode d’entrée de la console est défini pour **activer l' \_ \_ entrée** de la fenêtre (autrement dit, le mode par défaut est désactivé).</span><span class="sxs-lookup"><span data-stu-id="1a417-148">Buffer-resizing events are placed in the input buffer if the console's input mode is set to **ENABLE\_WINDOW\_INPUT** (that is, the default mode is disabled).</span></span>

<span data-ttu-id="1a417-149">Si l’événement d’entrée est un événement de redimensionnement de la mémoire tampon, le membre de l' **événement** de l' [**\_ enregistrement d’entrée**](input-record-str.md) est une structure d’enregistrement de taille de la [**\_ mémoire tampon \_ \_ de fenêtre**](window-buffer-size-record-str.md) contenant la nouvelle taille de la mémoire tampon de l’écran de la console, exprimée en colonnes et lignes de cellule de caractères.</span><span class="sxs-lookup"><span data-stu-id="1a417-149">If the input event is a buffer-resizing event, the **Event** member of [**INPUT\_RECORD**](input-record-str.md) is a [**WINDOW\_BUFFER\_SIZE\_RECORD**](window-buffer-size-record-str.md) structure containing the new size of the console screen buffer, expressed in character-cell columns and rows.</span></span>

<span data-ttu-id="1a417-150">Si l’utilisateur réduit la taille de la mémoire tampon d’écran de la console, toutes les données contenues dans la partie ignorée du tampon sont perdues.</span><span class="sxs-lookup"><span data-stu-id="1a417-150">If the user reduces the size of the console screen buffer, any data in the discarded portion of the buffer is lost.</span></span>

<span data-ttu-id="1a417-151">Les modifications apportées à la taille de la mémoire tampon d’écran de la console suite à des appels d’application à la fonction [**SetConsoleScreenBufferSize**](setconsolescreenbuffersize.md) ne sont pas générées en tant qu’événements de redimensionnement de mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="1a417-151">Changes to the console screen buffer size as a result of application calls to the [**SetConsoleScreenBufferSize**](setconsolescreenbuffersize.md) function are not generated as buffer-resizing events.</span></span>
