---
title: API de console classiques et séquences de terminaux virtuels
description: Décrit le contraste entre la surface de l’API de la console Win32 classique et le concept des séquences de terminaux virtuels, parfois également appelées séquences d’échappement, pour écrire des applications en ligne de commande.
author: miniksa
ms.author: miniksa
ms.topic: conceptual
keywords: console, terminal, terminal virtuel, séquences d’échappement, VT, VT100, API de console
ms.prod: console
ms.localizationpriority: high
ms.openlocfilehash: 541300b50521909b22ceaccb595f1945fbfc7e6d
ms.sourcegitcommit: 508e93bc83b4bca6ce678f88ab081d66b95d605c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/01/2020
ms.locfileid: "96420178"
---
# <a name="classic-console-apis-versus-virtual-terminal-sequences"></a><span data-ttu-id="7ed9c-104">API de console classiques et séquences de terminaux virtuels</span><span class="sxs-lookup"><span data-stu-id="7ed9c-104">Classic Console APIs versus Virtual Terminal Sequences</span></span>

<span data-ttu-id="7ed9c-105">Nous vous recommandons de remplacer l' **API de console Windows** classique par des **séquences de terminaux virtuels**.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-105">Our recommendation is to replace the classic **Windows Console API** with **virtual terminal sequences**.</span></span> <span data-ttu-id="7ed9c-106">Cet article présente la différence entre les deux et évoque les raisons de notre recommandation.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-106">This article will outline the difference between the two and discuss the reasons for our recommendation.</span></span>

## <a name="definitions"></a><span data-ttu-id="7ed9c-107">Définitions</span><span class="sxs-lookup"><span data-stu-id="7ed9c-107">Definitions</span></span>

<span data-ttu-id="7ed9c-108">La surface de l’API de la **[console Windows](console-functions.md)** classique est définie comme la série d’interfaces fonctionnelles du langage C sur `kernel32.dll` avec « console » dans le nom.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-108">The classic **[Windows Console API](console-functions.md)** surface is defined as the series of C language functional interfaces on `kernel32.dll` with "Console" in the name.</span></span>

<span data-ttu-id="7ed9c-109">Les **[séquences de terminaux virtuels](console-virtual-terminal-sequences.md)** sont définies comme un langage de commandes incorporées dans les flux de sortie standard et d’entrée.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-109">**[Virtual terminal sequences](console-virtual-terminal-sequences.md)** is defined as a language of commands that's embedded in the standard input and standard output streams.</span></span> <span data-ttu-id="7ed9c-110">Les séquences de terminaux virtuels utilisent des caractères d’échappement non imprimables pour les commandes de signalisation entrelacées avec du texte imprimable normal.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-110">Virtual terminal sequences use non-printable escape characters for signaling commands interleaved with normal printable text.</span></span>

## <a name="history"></a><span data-ttu-id="7ed9c-111">Historique</span><span class="sxs-lookup"><span data-stu-id="7ed9c-111">History</span></span>

<span data-ttu-id="7ed9c-112">La **console Windows** fournit une surface d’API étendue pour les applications de ligne de commande client pour manipuler à la fois le tampon d’affichage de sortie et la mémoire tampon d’entrée utilisateur.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-112">The **Windows Console** provides a broad API surface for client command-line applications to manipulate both the output display buffer and the user input buffer.</span></span> <span data-ttu-id="7ed9c-113">Toutefois, d’autres plateformes non-Windows n’ont jamais permis cette approche pilotée par les API spécifique à leurs environnements de ligne de commande, en choisissant plutôt d’utiliser des séquences de terminaux virtuels incorporées dans les flux de sortie standard d’entrée et standard.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-113">However, other non-Windows platforms have never afforded this specific API-driven approach to their command-line environments, choosing instead to use virtual terminal sequences embedded within the standard input and standard output streams.</span></span> <span data-ttu-id="7ed9c-114">*(Pendant une période, Microsoft a également pris en charge ce comportement dans les premières éditions de DOS et Windows par le biais d’un pilote appelé ANSI.SYS.)*</span><span class="sxs-lookup"><span data-stu-id="7ed9c-114">*(For a time, Microsoft supported this behavior too in early editions of DOS and Windows through a driver called ANSI.SYS.)*</span></span>

<span data-ttu-id="7ed9c-115">En revanche, les **séquences de terminaux virtuels** (dans divers dialectes) pilotent les opérations de l’environnement de ligne de commande pour toutes les autres plateformes.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-115">By contrast, **virtual terminal sequences** (in a variety of dialects) drive the command-line environment operations for  all other platforms.</span></span> <span data-ttu-id="7ed9c-116">Ces séquences sont enracinées dans une [norme](https://www.ecma-international.org/publications/standards/Ecma-048.htm) et une série d’extensions ECMA par de nombreux fournisseurs qui effectuent le suivi des terminaux Digital Equipment Corporation et Tektronix, par le biais de terminaux logiciels plus modernes et courants, tels que [xterm](https://invisible-island.net/xterm/).</span><span class="sxs-lookup"><span data-stu-id="7ed9c-116">These sequences are rooted in an [ECMA Standard](https://www.ecma-international.org/publications/standards/Ecma-048.htm) and series of extensions by many vendors tracing back to Digital Equipment Corporation and Tektronix terminals, through to more modern and common software terminals, like [xterm](https://invisible-island.net/xterm/).</span></span> <span data-ttu-id="7ed9c-117">De nombreuses extensions existent au sein du domaine de séquence de terminaux virtuels et certaines séquences sont plus largement prises en charge que d’autres, mais il est possible de dire que le monde s’est standardisé en tant que langage de commande pour les expériences de ligne de commande avec un sous-ensemble connu pris en charge par pratiquement toutes les applications clientes terminal et de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-117">Many extensions exist within the virtual terminal sequence domain and some sequences are more widely supported than others, but it is safe to say that the world has standardized on this as the command language for command-line experiences with a well-known subset being supported by virtually every terminal and command-line client application.</span></span>

## <a name="cross-platform-support"></a><span data-ttu-id="7ed9c-118">Prise en charge multiplateforme</span><span class="sxs-lookup"><span data-stu-id="7ed9c-118">Cross-Platform Support</span></span>

<span data-ttu-id="7ed9c-119">Les **séquences de terminaux virtuels** sont prises en charge de façon native sur les plateformes, ce qui rend les applications terminal et les utilitaires de ligne de commande facilement transférables entre les versions et les variantes de systèmes d’exploitation, à l’exception de Windows.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-119">**Virtual terminal sequences** are natively supported across platforms, making terminal applications and command-line utilities easily portable between versions and variations of operating systems, with the exception of Windows.</span></span>

<span data-ttu-id="7ed9c-120">En revanche, les **API de console Windows** sont uniquement prises en charge sur Windows.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-120">By contrast, **Windows Console APIs** are only supported on Windows.</span></span> <span data-ttu-id="7ed9c-121">Un adaptateur étendu ou une bibliothèque de traduction doit être écrit entre Windows et le terminal virtuel, ou vice versa, lors de la tentative de portage des utilitaires de ligne de commande d’une plateforme ou d’une autre.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-121">An extensive adapter or translation library must be written between Windows and virtual terminal, or vice-versa, when attempting to port command-line utilities from one platform or another.</span></span>

### <a name="remote-access"></a><span data-ttu-id="7ed9c-122">Accès à distance</span><span class="sxs-lookup"><span data-stu-id="7ed9c-122">Remote Access</span></span>

<span data-ttu-id="7ed9c-123">Les **séquences de terminaux virtuels** possèdent un avantage majeur pour l’accès à distance.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-123">**Virtual terminal sequences** hold a major advantage for remote access.</span></span> <span data-ttu-id="7ed9c-124">Ils ne nécessitent aucun travail supplémentaire pour le transport ou effectuent des appels de procédure distante, sur ce qui est requis pour configurer une connexion de ligne de commande à distance standard.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-124">They require no additional work to transport, or perform remote procedure calls, over what is required to set up a standard remote command-line connection.</span></span> <span data-ttu-id="7ed9c-125">Il suffit de connecter un canal de transport sortant et un canal de transport entrant (ou un canal bidirectionnel unique) sur un canal, un socket, un fichier, un port série ou tout autre appareil pour fournir complètement toutes les informations requises pour qu’une application contienne ces séquences sur un hôte distant.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-125">Simply connecting an outbound and an inbound transport channel (or a single bidirectional channel) over a pipe, socket, file, serial port, or any other device is sufficient to completely carry all information required for an application speaking these sequences to a remote host.</span></span>

<span data-ttu-id="7ed9c-126">En revanche, les **API de console Windows** sont uniquement accessibles sur l’ordinateur local et tous les efforts à distance nécessitent la création d’une couche d’appel et de transport à distance complète au-delà d’un simple canal.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-126">On the contrary, the **Windows Console APIs** have only been accessible on the local machine and all efforts to remote them would require building an entire remote calling and transport interface layer beyond just a simple channel.</span></span>

### <a name="separation-of-concerns"></a><span data-ttu-id="7ed9c-127">Séparation des responsabilités</span><span class="sxs-lookup"><span data-stu-id="7ed9c-127">Separation of Concerns</span></span>

<span data-ttu-id="7ed9c-128">Certaines **API de console Windows** fournissent un accès de bas niveau aux mémoires tampons d’entrée et de sortie ou aux fonctions pratiques pour les lignes de commande interactives.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-128">Some **Windows Console APIs** provide low-level access to the input and output buffers or convenience functions for interactive command-lines.</span></span> <span data-ttu-id="7ed9c-129">Cela peut inclure les alias et l’historique des commandes programmés dans le sous-système de la console et l’environnement hôte, plutôt que dans l’application cliente de ligne de commande elle-même.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-129">This might include aliases and command history programmed within the console subsystem and host environment, instead of within the command-line client application itself.</span></span>

<span data-ttu-id="7ed9c-130">En revanche, d' **autres plateformes** rendent la mémoire de l’état actuel de l’application et les fonctionnalités pratiques de la responsabilité de l’utilitaire de ligne de commande ou de l’interpréteur de commandes lui-même.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-130">By contrast, **other platforms** make memory of the current state of the application and convenience functionality the responsibility of the command-line utility or shell itself.</span></span>

<span data-ttu-id="7ed9c-131">La **console Windows** de gestion de cette responsabilité dans l’hôte de la console et l’API permet d’écrire plus rapidement et plus facilement une application en ligne de commande avec ces fonctionnalités, en supprimant la responsabilité de mémoriser l’état du dessin ou de gérer les fonctionnalités de l’édition.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-131">The **Windows Console** way of handling this responsibility in the console host and API makes it quicker and easier to write a command-line application with these features, removing the responsibility of remembering drawing state or handling editing convenience features.</span></span> <span data-ttu-id="7ed9c-132">Toutefois, il est presque impossible de connecter ces activités à distance sur des plateformes, des versions ou des scénarios en raison des variations des implémentations et de la disponibilité.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-132">However, this makes it nearly impossible to connect those activities remotely across platforms, versions, or scenarios due to variations in implementations and availability.</span></span> <span data-ttu-id="7ed9c-133">Cette façon de gérer la responsabilité rend également l’expérience interactive finale de ces applications en ligne de commande Windows entièrement dépendante de l’implémentation, des priorités et du cycle de publication de l’hôte de console.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-133">This way of handling responsibility also makes the final interactive experience of these Windows command-line applications completely dependent on the console host's implementation, priorities, and release cycle.</span></span>

<span data-ttu-id="7ed9c-134">Par exemple, les fonctionnalités avancées de modification de ligne, comme la mise en surbrillance de la syntaxe et la sélection complexe, ne sont possibles que si une application en ligne de commande gère elle-même les problèmes.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-134">For example, advanced line editing features, like syntax highlighting and complex selection, are only possible when a command-line application handles editing concerns itself.</span></span> <span data-ttu-id="7ed9c-135">La console ne pouvait jamais avoir suffisamment de contexte pour bien comprendre ces scénarios de manière générale, comme dans le cas de l’application cliente.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-135">The console could never have enough context to fully understand these scenarios in a broad manner like the client application can.</span></span>

<span data-ttu-id="7ed9c-136">En revanche, d’autres plateformes utilisent des **séquences de terminaux virtuels** pour gérer ces activités et la communication de terminal virtuel lui-même par le biais de bibliothèques côté client réutilisables, telles que [ReadLine](https://tiswww.case.edu/php/chet/readline/rltop.html) et [ncurses](https://invisible-island.net/ncurses/ncurses.html).</span><span class="sxs-lookup"><span data-stu-id="7ed9c-136">By contrast, other platforms use **virtual terminal sequences** to handle these activities and virtual terminal communication itself through reusable client-side libraries, like [readline](https://tiswww.case.edu/php/chet/readline/rltop.html) and [ncurses](https://invisible-island.net/ncurses/ncurses.html).</span></span> <span data-ttu-id="7ed9c-137">Le terminal final est uniquement responsable de l’affichage des informations et de la réception des entrées via ce canal de communication bidirectionnel.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-137">The final terminal is only responsible for displaying information and receiving input through that bidirectional communication channel.</span></span>

### <a name="wrong-way-verbs"></a><span data-ttu-id="7ed9c-138">Verbes de Wrong-Way</span><span class="sxs-lookup"><span data-stu-id="7ed9c-138">Wrong-Way Verbs</span></span>

<span data-ttu-id="7ed9c-139">Avec la **console Windows**, certaines actions peuvent être effectuées dans la direction opposée au naturel sur les flux d’entrée et de sortie.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-139">With **Windows Console**, some actions can be performed in the opposite-to-natural direction on the input and output streams.</span></span> <span data-ttu-id="7ed9c-140">Cela permet aux applications en ligne de commande Windows d’éviter la préoccupation de gérer leurs propres tampons.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-140">This allows Windows command-line applications to avoid the concern of managing their own buffers.</span></span> <span data-ttu-id="7ed9c-141">Il permet également aux applications de ligne de commande Windows d’effectuer des opérations avancées, telles que la simulation/l’injection d’entrée pour le compte d’un utilisateur, ou la lecture d’un historique de ce qui a été écrit.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-141">It also allows Windows command-line apps to perform advanced operations, like simulating/injecting input on behalf of a user, or reading back some of the history of what was written.</span></span>

<span data-ttu-id="7ed9c-142">Bien que cela offre une alimentation supplémentaire aux applications Windows opérant dans un contexte utilisateur spécifique sur un ordinateur unique, elle fournit également un vecteur pour franchir la sécurité et les niveaux de privilège ou les domaines lorsqu’ils sont utilisés dans certains scénarios.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-142">While this provides additional power to Windows applications operating in a specific user-context on a single machine, it also provides a vector to cross security and privilege-levels or domains when used in certain scenarios.</span></span> <span data-ttu-id="7ed9c-143">Ces scénarios incluent l’utilisation de contextes sur le même ordinateur, ou dans des contextes sur un autre ordinateur ou environnement.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-143">Such scenarios include operating between contexts on the same machine, or across contexts to another machine or environment.</span></span>

<span data-ttu-id="7ed9c-144">D’autres plateformes, qui utilisent des **séquences de terminaux virtuels**, n’autorisent pas cette activité.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-144">Other platforms, which use **virtual terminal sequences**, do not allow this activity.</span></span> <span data-ttu-id="7ed9c-145">L’objectif de notre recommandation de passer de la console Windows classique aux séquences de terminaux virtuels est de converger avec cette stratégie pour des raisons d’interopérabilité et de sécurité.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-145">The intent of our recommendation to transition from classic Windows Console to virtual terminal sequences is to converge with this strategy for both interoperability and security reasons.</span></span>

### <a name="direct-window-access"></a><span data-ttu-id="7ed9c-146">Accès direct à la fenêtre</span><span class="sxs-lookup"><span data-stu-id="7ed9c-146">Direct Window Access</span></span>

<span data-ttu-id="7ed9c-147">La surface de l’API de la **console Windows** fournit le handle de fenêtre exact à la fenêtre d’hébergement.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-147">**Windows Console API surface** provides the exact window handle to the hosting window.</span></span> <span data-ttu-id="7ed9c-148">Cela permet à un utilitaire de ligne de commande d’effectuer des opérations de fenêtre avancées en atteignant la large gamme d’API Win32 autorisées sur un handle de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-148">This allows a command-line utility to perform advanced window operations by reaching into the wide gamut of Win32 APIs permitted against a window handle.</span></span> <span data-ttu-id="7ed9c-149">Ces API Win32 peuvent manipuler l’état de la fenêtre, le frame, l’icône ou d’autres propriétés de la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-149">These Win32 APIs can manipulate the window state, frame, icon, or other properties about the window.</span></span>

<span data-ttu-id="7ed9c-150">En revanche, sur d’autres plateformes avec des **séquences de terminaux virtuels**, il existe un ensemble étroit de commandes pouvant être exécutées sur la fenêtre.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-150">By contrast, on other platforms with **virtual terminal sequences**, there is a narrow set of commands that can be performed against the window.</span></span> <span data-ttu-id="7ed9c-151">Ces commandes peuvent effectuer des opérations telles que la modification de la taille de la fenêtre ou du titre affiché, mais elles doivent être effectuées dans la même bande et sous le même contrôle que le reste du flux.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-151">These commands can do things like changing the window size or displayed title, but they must be done in the same band and under the same control as the remainder of the stream.</span></span>

<span data-ttu-id="7ed9c-152">À mesure que Windows a évolué, les contrôles de sécurité et les restrictions sur les handles de fenêtre ont augmenté.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-152">As Windows has evolved, the security controls and restrictions on window handles have increased.</span></span> <span data-ttu-id="7ed9c-153">En outre, la nature et l’existence d’un descripteur de fenêtre adressable par l’application sur n’importe quel élément d’interface utilisateur spécifique a évolué, en particulier avec la prise en charge accrue des facteurs de forme de périphérique et des plateformes.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-153">Additionally, the nature and existence of an application-addressable window handle on any specific user interface element has evolved, especially with the increased support of device form factors and platforms.</span></span> <span data-ttu-id="7ed9c-154">Cela permet d’accéder directement aux applications en ligne de commande fragiles à mesure que la plateforme et les expériences évoluent.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-154">This makes direct window access to command-line applications fragile as the platform and experiences evolve.</span></span>

### <a name="unicode"></a><span data-ttu-id="7ed9c-155">Unicode</span><span class="sxs-lookup"><span data-stu-id="7ed9c-155">Unicode</span></span>

<span data-ttu-id="7ed9c-156">UTF-8 est l’encodage accepté pour les données Unicode sur presque toutes les plateformes modernes, car il a un juste équilibre entre la portabilité, la taille de stockage et le temps de traitement.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-156">UTF-8 is the accepted encoding for Unicode data across almost all modern platforms, as it strikes the right balance between portability, storage size and processing time.</span></span> <span data-ttu-id="7ed9c-157">Toutefois, Windows a choisi l’encodage UTF-16 comme principal codage pour les données Unicode.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-157">However, Windows historically chose UTF-16 as its primary encoding for Unicode data.</span></span> <span data-ttu-id="7ed9c-158">La prise en charge d’UTF-8 s’améliore dans Windows et l’utilisation de ces formats Unicode n’exclut pas l’utilisation d’autres encodages.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-158">Support for UTF-8 is increasing in Windows and use of these Unicode formats does not preclude the usage of other encodings.</span></span>

<span data-ttu-id="7ed9c-159">La plateforme de la **console Windows** est prise en charge et continuera à prendre en charge l’ensemble des pages de codes et des encodages existants.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-159">The **Windows Console** platform has supported and will continue to support all existing code pages and encodings.</span></span> <span data-ttu-id="7ed9c-160">Utilisez UTF-16 pour une compatibilité maximale entre les différentes versions de Windows et effectuez une traduction algorithmique avec UTF-8, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-160">Use UTF-16 for maximum compatibility across Windows versions and perform algorithmic translation with UTF-8 if necessary.</span></span> <span data-ttu-id="7ed9c-161">L’augmentation de la prise en charge d’UTF-8 est en cours pour le système de la console.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-161">Increased support of UTF-8 is in progress for the console system.</span></span>

<span data-ttu-id="7ed9c-162">La prise en charge d’UTF-16 dans la console peut être utilisée sans aucune configuration supplémentaire via la variante _W_ de toutes les API de console. il s’agit d’un choix plus probable pour les applications qui sont déjà bien au format UTF-16 par le biais de la communication avec la `wchar_t` variante et _W_ des autres fonctions et produits de la plate-forme Microsoft et Windows.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-162">UTF-16 support in the console can be utilized with no additional configuration via the _W_ variant of all console APIs and is a more likely choice for applications already well versed in UTF-16 through communication with the `wchar_t` and _W_ variant of other Microsoft and Windows platform functions and products.</span></span>

<span data-ttu-id="7ed9c-163">La prise en charge d’UTF-8 dans la console peut être utilisée par le biais d' _une_ variante d’API de console sur des handles de console après avoir défini la page de codes sur `65001` ou `CP_UTF8` avec les méthodes [**SetConsoleOutputCP**](setconsoleoutputcp.md) et [**SetConsoleCP**](setconsolecp.md) , selon le cas.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-163">UTF-8 support in the console can be utilized via the _A_ variant of Console APIs against console handles after setting the codepage to `65001` or `CP_UTF8` with the [**SetConsoleOutputCP**](setconsoleoutputcp.md) and [**SetConsoleCP**](setconsolecp.md) methods, as appropriate.</span></span> <span data-ttu-id="7ed9c-164">La définition des pages de codes à l’avance n’est nécessaire que si la machine n’a pas choisi « utiliser Unicode UTF-8 pour la prise en charge des langues mondiales » dans la section paramètres pour les applications non-Unicode dans la zone région du panneau de configuration.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-164">Setting the code pages in advance is only necessary if the machine has not chosen "Use Unicode UTF-8 for worldwide language support" in the settings for Non-Unicode applications in the Region section of the Control Panel.</span></span>

>[!NOTE]
> <span data-ttu-id="7ed9c-165">À l’heure actuelle, UTF-8 est entièrement pris en charge sur le flux de sortie standard avec les méthodes [**WriteConsole**](writeconsole.md) et [**WriteFile**](https://msdn.microsoft.com/library/windows/desktop/aa365747) .</span><span class="sxs-lookup"><span data-stu-id="7ed9c-165">As of now, UTF-8 is supported fully on the standard output stream with the [**WriteConsole**](writeconsole.md) and [**WriteFile**](https://msdn.microsoft.com/library/windows/desktop/aa365747) methods.</span></span> <span data-ttu-id="7ed9c-166">La prise en charge du flux d’entrée varie selon le mode d’entrée et continue à s’améliorer au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-166">Support on the input stream varies depending on the input mode and will continue to improve over time.</span></span> <span data-ttu-id="7ed9c-167">En particulier, les modes **[« cuits »](high-level-console-modes.md)** par défaut en entrée ne prennent pas encore en charge UTF-8.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-167">Notably the default **["cooked"](high-level-console-modes.md)** modes on input do not fully support UTF-8 yet.</span></span> <span data-ttu-id="7ed9c-168">L’état actuel de ce travail est disponible à l’adresse suivante : [**Microsoft/Terminal # °**](https://github.com/microsoft/terminal/issues/7777) github.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-168">The current status of this work can be found at [**microsoft/terminal#7777**](https://github.com/microsoft/terminal/issues/7777) on GitHub.</span></span> <span data-ttu-id="7ed9c-169">La solution de contournement consiste à utiliser l’UTF-16 convertible algorithmiquement pour lire les entrées via [**ReadConsoleW**](readconsole.md) ou [**ReadConsoleInputW**](readconsoleinput.md) jusqu’à ce que les problèmes en suspens soient résolus.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-169">The workaround is to use the algorithmically-translatable UTF-16 for reading input through [**ReadConsoleW**](readconsole.md) or [**ReadConsoleInputW**](readconsoleinput.md) until the outstanding issues are resolved.</span></span>

## <a name="recommendations"></a><span data-ttu-id="7ed9c-170">Recommandations</span><span class="sxs-lookup"><span data-stu-id="7ed9c-170">Recommendations</span></span>

<span data-ttu-id="7ed9c-171">Pour tous les développements nouveaux et en continu sur Windows, les **séquences de terminaux virtuels sont recommandées** comme méthode d’interaction avec le terminal.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-171">For all new and ongoing development on Windows, **virtual terminal sequences are recommended** as the way of interacting with the terminal.</span></span> <span data-ttu-id="7ed9c-172">Cela convergera les applications clientes de ligne de commande Windows avec le style de programmation d’application sur toutes les autres plateformes.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-172">This will converge Windows command-line client applications with the style of application programming on all other platforms.</span></span>

### <a name="exceptions-for-using-windows-console-apis"></a><span data-ttu-id="7ed9c-173">Exceptions pour l’utilisation des API de console Windows</span><span class="sxs-lookup"><span data-stu-id="7ed9c-173">Exceptions for using Windows Console APIs</span></span>

<span data-ttu-id="7ed9c-174">Un **sous-ensemble limité d’API de console Windows est toujours nécessaire** pour établir l’environnement initial.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-174">A **limited subset of Windows Console APIs is still necessary** to establish the initial environment.</span></span> <span data-ttu-id="7ed9c-175">La plate-forme Windows diffère encore des autres dans le processus, les signaux, les périphériques et la gestion de l’encodage :</span><span class="sxs-lookup"><span data-stu-id="7ed9c-175">The Windows platform still differs from others in process, signal, device, and encoding handling:</span></span>

- <span data-ttu-id="7ed9c-176">Les handles standard d’un processus sont toujours contrôlés avec **[GetStdHandle](getstdhandle.md)** et **[SetStdHandle](setstdhandle.md)**.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-176">The standard handles to a process will still be controlled with **[GetStdHandle](getstdhandle.md)** and **[SetStdHandle](setstdhandle.md)**.</span></span>

- <span data-ttu-id="7ed9c-177">La configuration des modes de console sur un handle pour s’abonner à une séquence de terminaux virtuels est gérée avec **[GetConsoleMode](getconsolemode.md)** et **[SetConsoleMode](setconsolemode.md)**.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-177">Configuration of the console modes on a handle to opt in to Virtual Terminal Sequence support will be handled with **[GetConsoleMode](getconsolemode.md)** and **[SetConsoleMode](setconsolemode.md)**.</span></span>

- <span data-ttu-id="7ed9c-178">La déclaration de la page de codes ou la prise en charge UTF-8 est effectuée avec les méthodes [**SetConsoleOutputCP**](setconsoleoutputcp.md) et [**SetConsoleCP**](setconsolecp.md) .</span><span class="sxs-lookup"><span data-stu-id="7ed9c-178">Declaration of code page or UTF-8 support is conducted with [**SetConsoleOutputCP**](setconsoleoutputcp.md) and [**SetConsoleCP**](setconsolecp.md) methods.</span></span>

- <span data-ttu-id="7ed9c-179">Un certain niveau de gestion globale des processus peut être nécessaire avec [**AllocConsole**](allocconsole.md), [**AttachConsole**](attachconsole.md) et [**FreeConsole**](freeconsole.md) pour rejoindre ou abandonner une session de périphérique de la console.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-179">Some level of overall process management may be required with the [**AllocConsole**](allocconsole.md), [**AttachConsole**](attachconsole.md) and [**FreeConsole**](freeconsole.md) to join or leave a console device session.</span></span>

- <span data-ttu-id="7ed9c-180">Les signaux et la gestion des signaux continueront d’être effectués avec [**SetConsoleCtrlHandler**](setconsolectrlhandler.md), [**HandlerRoutine**](handlerroutine.md)et [**GenerateConsoleCtrlEvent**](generateconsolectrlevent.md).</span><span class="sxs-lookup"><span data-stu-id="7ed9c-180">Signals and signal handling will continue to be conducted with [**SetConsoleCtrlHandler**](setconsolectrlhandler.md), [**HandlerRoutine**](handlerroutine.md), and [**GenerateConsoleCtrlEvent**](generateconsolectrlevent.md).</span></span>

- <span data-ttu-id="7ed9c-181">La communication avec les descripteurs de l’appareil de la console peut être effectuée avec [**WriteConsole**](writeconsole.md) et [**ReadConsole**](readconsole.md).</span><span class="sxs-lookup"><span data-stu-id="7ed9c-181">Communication with the console device handles can be conducted with [**WriteConsole**](writeconsole.md) and [**ReadConsole**](readconsole.md).</span></span> <span data-ttu-id="7ed9c-182">Elles peuvent également être exploitées par le biais de runtimes de langage de programmation dans les formulaires de :-C Runtime (CRT) : [e/s de flux](https://docs.microsoft.com/cpp/c-runtime-library/stream-i-o) comme **printf**, **scanf**, **putc**, **GETC** ou [d’autres niveaux de fonctions d’e/s](https://docs.microsoft.com/cpp/c-runtime-library/input-and-output).</span><span class="sxs-lookup"><span data-stu-id="7ed9c-182">These may also be leveraged through programming language runtimes in the forms of: - C Runtime (CRT): [Stream I/O](https://docs.microsoft.com/cpp/c-runtime-library/stream-i-o) like **printf**, **scanf**, **putc**, **getc**, or [other levels of I/O functions](https://docs.microsoft.com/cpp/c-runtime-library/input-and-output).</span></span>
        <span data-ttu-id="7ed9c-183">-Bibliothèque standard C++ (STL) : [iostream](https://docs.microsoft.com/cpp/standard-library/iostream) comme **cout** et **CIN**.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-183">- C++ Standard Library (STL): [iostream](https://docs.microsoft.com/cpp/standard-library/iostream) like **cout** and **cin**.</span></span>
        <span data-ttu-id="7ed9c-184">-Runtime .NET : [System. console](https://docs.microsoft.com/dotnet/api/system.console) , comme **console. WriteLine**.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-184">- .NET Runtime: [System.Console](https://docs.microsoft.com/dotnet/api/system.console) like **Console.WriteLine**.</span></span>

- <span data-ttu-id="7ed9c-185">Les applications qui doivent être conscientes des modifications de taille de fenêtre devront toujours utiliser [**ReadConsoleInput**](readconsoleinput.md) pour les recevoir avec des événements clés, car **ReadConsole** seul les ignore.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-185">Applications that must be aware of window size changes will still need to use [**ReadConsoleInput**](readconsoleinput.md) to receive them interleaved with key events as **ReadConsole** alone will discard them.</span></span>

- <span data-ttu-id="7ed9c-186">La recherche de la taille de la fenêtre doit toujours être effectuée avec [**GetConsoleScreenBufferInfo**](getconsolescreenbufferinfo.md) pour les applications tentant de dessiner des colonnes, des grilles ou de remplir l’affichage.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-186">Finding the window size must still be performed with [**GetConsoleScreenBufferInfo**](getconsolescreenbufferinfo.md) for applications attempting to draw columns, grids, or fill the display.</span></span> <span data-ttu-id="7ed9c-187">La taille de la fenêtre et de la mémoire tampon correspond à celle d’une session [pseudoconsole](pseudoconsoles.md) .</span><span class="sxs-lookup"><span data-stu-id="7ed9c-187">Window and buffer size will match in a [pseudoconsole](pseudoconsoles.md) session.</span></span>

## <a name="future-planning-and-pseudoconsole"></a><span data-ttu-id="7ed9c-188">Planification et pseudoconsole à venir</span><span class="sxs-lookup"><span data-stu-id="7ed9c-188">Future planning and pseudoconsole</span></span>

<span data-ttu-id="7ed9c-189">Il n’est pas prévu de supprimer les API de console Windows de la plateforme.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-189">There are no plans to remove the Windows console APIs from the platform.</span></span>

<span data-ttu-id="7ed9c-190">En revanche, l’hôte de console Windows a fourni la technologie **[pseudoconsole](pseudoconsoles.md)** pour traduire les appels d’application en ligne de commande Windows existants en séquences de terminaux virtuels et les transférer vers un autre environnement d’hébergement à distance ou sur plusieurs plateformes.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-190">On the contrary, the Windows Console host has provided the **[pseudoconsole](pseudoconsoles.md)** technology to translate existing Windows command-line application calls into virtual terminal sequences and forward them to another hosting environment remotely or across platforms.</span></span>

<span data-ttu-id="7ed9c-191">Cette traduction n’est pas parfaite.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-191">This translation is not perfect.</span></span> <span data-ttu-id="7ed9c-192">Elle nécessite que la fenêtre hôte de la console maintienne un environnement simulé de ce que Windows aurait affiché à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-192">It requires the console host window to maintain a simulated environment of what Windows would have displayed to the user.</span></span> <span data-ttu-id="7ed9c-193">Il projette ensuite un réplica de cet environnement simulé sur l’hôte **pseudoconsole** .</span><span class="sxs-lookup"><span data-stu-id="7ed9c-193">It then projects a replica of this simulated environment to the **pseudoconsole** host.</span></span> <span data-ttu-id="7ed9c-194">Tous les appels d’API de console Windows sont exécutés dans l’environnement simulé pour répondre aux besoins de l’application cliente de ligne de commande héritée.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-194">All Windows Console API calls are operated within the simulated environment to serve the needs of the legacy command-line client application.</span></span> <span data-ttu-id="7ed9c-195">Seuls les effets sont propagés sur l’hôte final.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-195">Only the effects are propagated onto the final host.</span></span>

<span data-ttu-id="7ed9c-196">Une application en ligne de commande désire la compatibilité complète entre les plateformes et la prise en charge complète de tous les nouveaux scénarios et fonctionnalités sur Windows et ailleurs est donc recommandée pour passer aux séquences de terminaux virtuels et ajuster l’architecture des applications en ligne de commande pour les aligner sur toutes les plateformes.</span><span class="sxs-lookup"><span data-stu-id="7ed9c-196">A command-line application desiring full compatibility across platforms and full support of all new features and scenarios both on Windows and elsewhere is therefore recommended to move to virtual terminal sequences and adjust the architecture of command-line applications to align with all platforms.</span></span>

<span data-ttu-id="7ed9c-197">Pour plus d’informations sur cette transition Windows pour les applications en ligne de commande, consultez notre feuille de route pour l' [écosystème](ecosystem-roadmap.md).</span><span class="sxs-lookup"><span data-stu-id="7ed9c-197">More information about this Windows transition for command-line applications can be found on our [ecosystem roadmap](ecosystem-roadmap.md).</span></span>
