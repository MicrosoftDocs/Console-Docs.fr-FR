---
title: Création d’une console
description: Le système crée une console quand il démarre un processus de console, qui est un processus en mode caractère dont le point d’entrée est la fonction main.
author: miniksa
ms.author: miniksa
ms.topic: conceptual
keywords: console, applications en mode caractère, applications en ligne de commande, applications de terminal, API console
MS-HAID:
- '\_win32\_creation\_of\_a\_console'
- base.creation\_of\_a\_console
- consoles.creation\_of\_a\_console
MSHAttr:
- PreferredSiteName:MSDN
- PreferredLib:/library/windows/desktop
ms.assetid: 84ec2559-cade-447e-8594-5b824d3d3e81
ms.localizationpriority: high
ms.openlocfilehash: 09de42ced585e4a644fbbcc04211d5cb6037c2af
ms.sourcegitcommit: 508e93bc83b4bca6ce678f88ab081d66b95d605c
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/04/2020
ms.locfileid: "96420278"
---
# <a name="creation-of-a-console"></a><span data-ttu-id="7f8aa-104">Création d’une console</span><span class="sxs-lookup"><span data-stu-id="7f8aa-104">Creation of a Console</span></span>

<span data-ttu-id="7f8aa-105">Le système crée une console quand il démarre un *processus de console*, qui est un processus en mode caractère dont le point d’entrée est la fonction **main**.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-105">The system creates a new console when it starts a *console process*, a character-mode process whose entry point is the **main** function.</span></span> <span data-ttu-id="7f8aa-106">Par exemple, le système crée une console quand il démarre le processeur de commande `cmd.exe`.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-106">For example, the system creates a new console when it starts the command processor `cmd.exe`.</span></span> <span data-ttu-id="7f8aa-107">Quand le processeur de commande démarre un nouveau processus de console, l’utilisateur peut spécifier si le système crée une console pour le nouveau processus ou s’il hérite de la console du processeur de commandes.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-107">When the command processor starts a new console process, the user can specify whether the system creates a new console for the new process or whether it inherits the command processor's console.</span></span>

<span data-ttu-id="7f8aa-108">Un processus peut créer une console en utilisant une des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="7f8aa-108">A process can create a console by using one of the following methods:</span></span>

- <span data-ttu-id="7f8aa-109">Une interface graphique utilisateur (GUI) ou un processus de console peut utiliser la fonction [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425) avec **CREATE\_NEW\_CONSOLE** pour créer un processus de console avec une nouvelle console.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-109">A graphical user interface (GUI) or console process can use the [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425) function with **CREATE\_NEW\_CONSOLE** to create a console process with a new console.</span></span> <span data-ttu-id="7f8aa-110">(Par défaut, un processus de console hérite de la console de son parent, et il n’y a pas de garantie que l’entrée est reçue par le processus auquel elle était destinée.)</span><span class="sxs-lookup"><span data-stu-id="7f8aa-110">(By default, a console process inherits its parent's console, and there is no guarantee that input is received by the process for which it was intended.)</span></span>
- <span data-ttu-id="7f8aa-111">Une interface graphique utilisateur ou un processus de console qui n’est pas actuellement attaché à une console peut utiliser la fonction [**AllocConsole**](allocconsole.md) pour créer une console.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-111">A GUI or console process that is not currently attached to a console can use the [**AllocConsole**](allocconsole.md) function to create a new console.</span></span> <span data-ttu-id="7f8aa-112">(Les processus GUI ne sont pas attachés à une console quand ils sont créés.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-112">(GUI processes are not attached to a console when they are created.</span></span> <span data-ttu-id="7f8aa-113">Les processus de console ne sont pas attachés à une console s’ils sont créés en utilisant [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425) avec **DETACHED\_PROCESS**.)</span><span class="sxs-lookup"><span data-stu-id="7f8aa-113">Console processes are not attached to a console if they are created using [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425) with **DETACHED\_PROCESS**.)</span></span>

<span data-ttu-id="7f8aa-114">En règle générale, un processus utilise [**AllocConsole**](allocconsole.md) pour créer une console quand une erreur se produit et demande une interaction avec l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-114">Typically, a process uses [**AllocConsole**](allocconsole.md) to create a console when an error occurs requiring interaction with the user.</span></span> <span data-ttu-id="7f8aa-115">Par exemple, un processus GUI peut créer une console quand une erreur se produit qui l’empêche d’utiliser son interface graphique normale, ou un processus de console qui n’interagit normalement pas avec l’utilisateur peut créer une console pour afficher une erreur.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-115">For example, a GUI process can create a console when an error occurs that prevents it from using its normal graphical interface, or a console process that does not normally interact with the user can create a console to display an error.</span></span>

<span data-ttu-id="7f8aa-116">Un processus peut aussi créer une console en spécifiant l’indicateur **CREATE\_NEW** CONSOLE\_dans un appel à [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425).</span><span class="sxs-lookup"><span data-stu-id="7f8aa-116">A process can also create a console by specifying the **CREATE\_NEW\_CONSOLE** flag in a call to [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425).</span></span> <span data-ttu-id="7f8aa-117">Cette méthode crée une console qui est accessible au processus enfant, mais pas au processus parent.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-117">This method creates a new console that is accessible to the child process but not to the parent process.</span></span> <span data-ttu-id="7f8aa-118">Des consoles distinctes permettent aux processus parents et enfants d’interagir sans conflit avec l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-118">Separate consoles enable both parent and child processes to interact with the user without conflict.</span></span> <span data-ttu-id="7f8aa-119">Si cet indicateur n’est pas spécifié lors de la création d’un processus de console, les deux processus sont attachés à la même console, et il n’y a pas de garantie que le processus correct recevra l’entrée qui lui est destinée.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-119">If this flag is not specified when a console process is created, both processes are attached to the same console, and there is no guarantee that the correct process will receive the input intended for it.</span></span> <span data-ttu-id="7f8aa-120">Les applications peuvent éviter les confusions en créant des processus enfants qui n’héritent pas des handles de la mémoire tampon d’entrée, ou en n’autorisant qu’un seul processus enfant à la fois pour hériter d’un handle de mémoire tampon d’entrée tout en empêchant le processus parent de lire l’entrée de la console jusqu’à ce que l’enfant ait terminé.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-120">Applications can prevent confusion by creating child processes that do not inherit handles of the input buffer, or by enabling only one child process at a time to inherit an input buffer handle while preventing the parent process from reading console input until the child has finished.</span></span>

<span data-ttu-id="7f8aa-121">La création d’une console entraîne la création d’une fenêtre de console ainsi que de mémoires tampons d’écran d’E/S distinctes.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-121">Creating a new console results in a new console window, as well as separate I/O screen buffers.</span></span> <span data-ttu-id="7f8aa-122">Le processus associé à la nouvelle console utilise la fonction [**GetStdHandle**](getstdhandle.md) pour récupérer les handles des mémoires tampons d’entrée et d’écran de la nouvelle console.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-122">The process associated with the new console uses the [**GetStdHandle**](getstdhandle.md) function to get the handles of the new console's input and screen buffers.</span></span> <span data-ttu-id="7f8aa-123">Ces handles permettent au processus d’accéder à la console.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-123">These handles enable the process to access the console.</span></span>

<span data-ttu-id="7f8aa-124">Quand un processus utilise [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425), il peut spécifier une structure [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331), dont les membres contrôlent les caractéristiques de la première nouvelle console (le cas échéant) créée pour le processus enfant.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-124">When a process uses [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425), it can specify a [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331) structure, whose members control the characteristics of the first new console (if any) created for the child process.</span></span> <span data-ttu-id="7f8aa-125">La structure **STARTUPINFO** spécifiée dans l’appel à **CreateProcess** affecte une console créée si l’indicateur **CREATE\_NEW\_CONSOLE** est spécifié.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-125">The **STARTUPINFO** structure specified in the call to **CreateProcess** affects a console created if the **CREATE\_NEW\_CONSOLE** flag is specified.</span></span> <span data-ttu-id="7f8aa-126">Elle affecte également une console créée si le processus enfant utilise par la suite [**AllocConsole**](allocconsole.md).</span><span class="sxs-lookup"><span data-stu-id="7f8aa-126">It also affects a console created if the child process subsequently uses [**AllocConsole**](allocconsole.md).</span></span> <span data-ttu-id="7f8aa-127">Les caractéristiques suivantes de la console peuvent être spécifiées :</span><span class="sxs-lookup"><span data-stu-id="7f8aa-127">The following console characteristics can be specified:</span></span>

- <span data-ttu-id="7f8aa-128">Taille de la nouvelle fenêtre de console, en cellules de caractères</span><span class="sxs-lookup"><span data-stu-id="7f8aa-128">Size of the new console window, in character cells</span></span>
- <span data-ttu-id="7f8aa-129">Emplacement de la nouvelle fenêtre de console, en coordonnées de pixels d’écran</span><span class="sxs-lookup"><span data-stu-id="7f8aa-129">Location of the new console window, in screen pixel coordinates</span></span>
- <span data-ttu-id="7f8aa-130">Taille de la mémoire tampon d’écran de la nouvelle console, en cellules de caractères</span><span class="sxs-lookup"><span data-stu-id="7f8aa-130">Size of the new console's screen buffer, in character cells</span></span>
- <span data-ttu-id="7f8aa-131">Attributs de couleur de texte et d’arrière-plan de la mémoire tampon d’écran de la nouvelle console</span><span class="sxs-lookup"><span data-stu-id="7f8aa-131">Text and background color attributes of the new console's screen buffer</span></span>
- <span data-ttu-id="7f8aa-132">Nom d’affichage de la barre de titre de la fenêtre de la nouvelle console</span><span class="sxs-lookup"><span data-stu-id="7f8aa-132">Display name for the title bar of the new console's window</span></span>

<span data-ttu-id="7f8aa-133">Le système utilise les valeurs par défaut si les valeurs de [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331) ne sont pas spécifiées.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-133">The system uses default values if the [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331) values are not specified.</span></span> <span data-ttu-id="7f8aa-134">Un processus enfant peut utiliser la fonction [**GetStartupInfo**](https://msdn.microsoft.com/library/windows/desktop/ms683230) pour déterminer les valeurs dans sa structure **STARTUPINFO**.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-134">A child process can use the [**GetStartupInfo**](https://msdn.microsoft.com/library/windows/desktop/ms683230) function to determine the values in its **STARTUPINFO** structure.</span></span>

<span data-ttu-id="7f8aa-135">Un processus ne peut pas changer l’emplacement de sa fenêtre de console sur l’écran, mais les fonctions de console suivantes sont disponibles pour définir ou récupérer les autres propriétés spécifiées dans la structure [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331).</span><span class="sxs-lookup"><span data-stu-id="7f8aa-135">A process cannot change the location of its console window on the screen, but the following console functions are available to set or retrieve the other properties specified in the [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331) structure.</span></span>

| <span data-ttu-id="7f8aa-136">Fonction</span><span class="sxs-lookup"><span data-stu-id="7f8aa-136">Function</span></span> | <span data-ttu-id="7f8aa-137">Description</span><span class="sxs-lookup"><span data-stu-id="7f8aa-137">Description</span></span> |
|-|-|
| [<span data-ttu-id="7f8aa-138">**GetConsoleScreenBufferInfo**</span><span class="sxs-lookup"><span data-stu-id="7f8aa-138">**GetConsoleScreenBufferInfo**</span></span>](getconsolescreenbufferinfo.md) | <span data-ttu-id="7f8aa-139">Récupère la taille de la fenêtre, la taille de la mémoire tampon d’écran et les attributs de couleur.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-139">Retrieves the window size, screen buffer size, and color attributes.</span></span> |
| [<span data-ttu-id="7f8aa-140">**SetConsoleWindowInfo**</span><span class="sxs-lookup"><span data-stu-id="7f8aa-140">**SetConsoleWindowInfo**</span></span>](setconsolewindowinfo.md)  | <span data-ttu-id="7f8aa-141">Change la taille de la fenêtre de console.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-141">Changes the size of the console window.</span></span>  |
| [<span data-ttu-id="7f8aa-142">**SetConsoleScreenBufferSize**</span><span class="sxs-lookup"><span data-stu-id="7f8aa-142">**SetConsoleScreenBufferSize**</span></span>](setconsolescreenbuffersize.md) | <span data-ttu-id="7f8aa-143">Change la taille de la mémoire tampon d’écran de console.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-143">Changes the size of the console screen buffer.</span></span> |
| [<span data-ttu-id="7f8aa-144">**SetConsoleTextAttribute**</span><span class="sxs-lookup"><span data-stu-id="7f8aa-144">**SetConsoleTextAttribute**</span></span>](setconsoletextattribute.md) | <span data-ttu-id="7f8aa-145">Définit les attributs de couleur.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-145">Sets the color attributes.</span></span>  |
| [<span data-ttu-id="7f8aa-146">**SetConsoleTitle**</span><span class="sxs-lookup"><span data-stu-id="7f8aa-146">**SetConsoleTitle**</span></span>](setconsoletitle.md)  | <span data-ttu-id="7f8aa-147">Définit le titre de la fenêtre de console.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-147">Sets the console window title.</span></span> |
| [<span data-ttu-id="7f8aa-148">**GetConsoleTitle**</span><span class="sxs-lookup"><span data-stu-id="7f8aa-148">**GetConsoleTitle**</span></span>](getconsoletitle.md)  | <span data-ttu-id="7f8aa-149">Récupère le titre de la fenêtre de console.</span><span class="sxs-lookup"><span data-stu-id="7f8aa-149">Retrieves the console window title.</span></span>  |

<span data-ttu-id="7f8aa-150">Un processus peut utiliser la fonction [**FreeConsole**](freeconsole.md) pour se détacher d’une console héritée ou d’une console créée par [**AllocConsole**](allocconsole.md).</span><span class="sxs-lookup"><span data-stu-id="7f8aa-150">A process can use the [**FreeConsole**](freeconsole.md) function to detach itself from an inherited console or from a console created by [**AllocConsole**](allocconsole.md).</span></span>

<span data-ttu-id="7f8aa-151">Un processus peut utiliser la fonction [**AttachConsole**](attachconsole.md) pour s’attacher à une autre session de console existante après avoir utilisé [**FreeConsole**](freeconsole.md) pour se détacher de sa propre session (ou s’il n’y a aucune autre session attachée).</span><span class="sxs-lookup"><span data-stu-id="7f8aa-151">A process can use the [**AttachConsole**](attachconsole.md) function to attach itself to another existing console session after using [**FreeConsole**](freeconsole.md) to detach from its own session (or if there is otherwise no attached session).</span></span>
