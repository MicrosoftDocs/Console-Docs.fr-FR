---
title: Création d’une console
description: Le système crée une nouvelle console lorsqu’il démarre un processus de console, un processus en mode caractère dont le point d’entrée est la fonction principale.
author: miniksa
ms.author: miniksa
ms.topic: conceptual
keywords: console, applications en mode caractère, applications en ligne de commande, applications de terminal, API console
MS-HAID:
- '\_win32\_creation\_of\_a\_console'
- base.creation\_of\_a\_console
- consoles.creation\_of\_a\_console
MSHAttr:
- PreferredSiteName:MSDN
- PreferredLib:/library/windows/desktop
ms.assetid: 84ec2559-cade-447e-8594-5b824d3d3e81
ms.openlocfilehash: 78a77044452fe2287a7cea0bfe5a6542eceef337
ms.sourcegitcommit: 463975e71920908a6bff9a6a7291ddf3736652d5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/30/2020
ms.locfileid: "93038237"
---
# <a name="creation-of-a-console"></a><span data-ttu-id="78f45-104">Création d’une console</span><span class="sxs-lookup"><span data-stu-id="78f45-104">Creation of a Console</span></span>

<span data-ttu-id="78f45-105">Le système crée une nouvelle console lorsqu’il démarre un *processus de console* , un processus en mode caractère dont le point d’entrée est la fonction **principale** .</span><span class="sxs-lookup"><span data-stu-id="78f45-105">The system creates a new console when it starts a *console process* , a character-mode process whose entry point is the **main** function.</span></span> <span data-ttu-id="78f45-106">Par exemple, le système crée une nouvelle console lorsqu’il démarre le processeur de commandes `cmd.exe` .</span><span class="sxs-lookup"><span data-stu-id="78f45-106">For example, the system creates a new console when it starts the command processor `cmd.exe`.</span></span> <span data-ttu-id="78f45-107">Lorsque le processeur de commande démarre un nouveau processus de console, l’utilisateur peut spécifier si le système crée une nouvelle console pour le nouveau processus ou s’il hérite de la console du processeur de commandes.</span><span class="sxs-lookup"><span data-stu-id="78f45-107">When the command processor starts a new console process, the user can specify whether the system creates a new console for the new process or whether it inherits the command processor's console.</span></span>

<span data-ttu-id="78f45-108">Un processus peut créer une console à l’aide de l’une des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="78f45-108">A process can create a console by using one of the following methods:</span></span>

- <span data-ttu-id="78f45-109">Une interface utilisateur graphique (GUI) ou un processus de console peut utiliser la fonction [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425) avec **Create \_ New \_ console** pour créer un processus de console avec une nouvelle console.</span><span class="sxs-lookup"><span data-stu-id="78f45-109">A graphical user interface (GUI) or console process can use the [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425) function with **CREATE\_NEW\_CONSOLE** to create a console process with a new console.</span></span> <span data-ttu-id="78f45-110">(Par défaut, un processus de console hérite de la console de son parent, et il n’y a aucune garantie que l’entrée est reçue par le processus auquel elle était destinée.)</span><span class="sxs-lookup"><span data-stu-id="78f45-110">(By default, a console process inherits its parent's console, and there is no guarantee that input is received by the process for which it was intended.)</span></span>
- <span data-ttu-id="78f45-111">Une interface utilisateur graphique ou un processus de console qui n’est pas actuellement attaché à une console peut utiliser la fonction [**AllocConsole**](allocconsole.md) pour créer une nouvelle console.</span><span class="sxs-lookup"><span data-stu-id="78f45-111">A GUI or console process that is not currently attached to a console can use the [**AllocConsole**](allocconsole.md) function to create a new console.</span></span> <span data-ttu-id="78f45-112">(Les processus GUI ne sont pas attachés à une console lorsqu’ils sont créés.</span><span class="sxs-lookup"><span data-stu-id="78f45-112">(GUI processes are not attached to a console when they are created.</span></span> <span data-ttu-id="78f45-113">Les processus de console ne sont pas attachés à une console s’ils sont créés à l’aide de [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425) avec un **\_ processus détaché** .)</span><span class="sxs-lookup"><span data-stu-id="78f45-113">Console processes are not attached to a console if they are created using [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425) with **DETACHED\_PROCESS** .)</span></span>

<span data-ttu-id="78f45-114">En règle générale, un processus utilise [**AllocConsole**](allocconsole.md) pour créer une console lorsqu’une erreur se produit et nécessite une interaction avec l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="78f45-114">Typically, a process uses [**AllocConsole**](allocconsole.md) to create a console when an error occurs requiring interaction with the user.</span></span> <span data-ttu-id="78f45-115">Par exemple, un processus d’interface graphique utilisateur peut créer une console lorsqu’une erreur se produit, l’empêchant d’utiliser son interface graphique normale, ou un processus de console qui n’interagit normalement pas avec l’utilisateur peut créer une console pour afficher une erreur.</span><span class="sxs-lookup"><span data-stu-id="78f45-115">For example, a GUI process can create a console when an error occurs that prevents it from using its normal graphical interface, or a console process that does not normally interact with the user can create a console to display an error.</span></span>

<span data-ttu-id="78f45-116">Un processus peut également créer une console en spécifiant l’indicateur **Create \_ New \_ console** dans un appel à [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425).</span><span class="sxs-lookup"><span data-stu-id="78f45-116">A process can also create a console by specifying the **CREATE\_NEW\_CONSOLE** flag in a call to [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425).</span></span> <span data-ttu-id="78f45-117">Cette méthode crée une nouvelle console qui est accessible au processus enfant, mais pas au processus parent.</span><span class="sxs-lookup"><span data-stu-id="78f45-117">This method creates a new console that is accessible to the child process but not to the parent process.</span></span> <span data-ttu-id="78f45-118">Des consoles distinctes permettent aux processus parents et enfants d’interagir sans conflit avec l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="78f45-118">Separate consoles enable both parent and child processes to interact with the user without conflict.</span></span> <span data-ttu-id="78f45-119">Si cet indicateur n’est pas spécifié lors de la création d’un processus de console, les deux processus sont attachés à la même console, et il n’y a aucune garantie que le processus correct recevra l’entrée qui lui est destinée.</span><span class="sxs-lookup"><span data-stu-id="78f45-119">If this flag is not specified when a console process is created, both processes are attached to the same console, and there is no guarantee that the correct process will receive the input intended for it.</span></span> <span data-ttu-id="78f45-120">Les applications peuvent éviter toute confusion en créant des processus enfants qui n’héritent pas de handles de la mémoire tampon d’entrée, ou en n’autorisant qu’un seul processus enfant à la fois pour hériter d’un handle de mémoire tampon d’entrée tout en empêchant le processus parent de lire l’entrée de la console jusqu’à la fin de l’enfant.</span><span class="sxs-lookup"><span data-stu-id="78f45-120">Applications can prevent confusion by creating child processes that do not inherit handles of the input buffer, or by enabling only one child process at a time to inherit an input buffer handle while preventing the parent process from reading console input until the child has finished.</span></span>

<span data-ttu-id="78f45-121">La création d’une nouvelle console entraîne une nouvelle fenêtre de console, ainsi que des mémoires tampons d’écran d’e/s distinctes.</span><span class="sxs-lookup"><span data-stu-id="78f45-121">Creating a new console results in a new console window, as well as separate I/O screen buffers.</span></span> <span data-ttu-id="78f45-122">Le processus associé à la nouvelle console utilise la fonction [**GetStdHandle**](getstdhandle.md) pour récupérer les descripteurs des mémoires tampons d’entrée et d’écran de la nouvelle console.</span><span class="sxs-lookup"><span data-stu-id="78f45-122">The process associated with the new console uses the [**GetStdHandle**](getstdhandle.md) function to get the handles of the new console's input and screen buffers.</span></span> <span data-ttu-id="78f45-123">Ces handles permettent au processus d’accéder à la console.</span><span class="sxs-lookup"><span data-stu-id="78f45-123">These handles enable the process to access the console.</span></span>

<span data-ttu-id="78f45-124">Lorsqu’un processus utilise [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425), il peut spécifier une structure [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331) , dont les membres contrôlent les caractéristiques de la première nouvelle console (le cas échéant) créée pour le processus enfant.</span><span class="sxs-lookup"><span data-stu-id="78f45-124">When a process uses [**CreateProcess**](https://msdn.microsoft.com/library/windows/desktop/ms682425), it can specify a [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331) structure, whose members control the characteristics of the first new console (if any) created for the child process.</span></span> <span data-ttu-id="78f45-125">La structure **STARTUPINFO** spécifiée dans l’appel à **CreateProcess** affecte une console créée si l’indicateur **Create \_ New \_ console** est spécifié.</span><span class="sxs-lookup"><span data-stu-id="78f45-125">The **STARTUPINFO** structure specified in the call to **CreateProcess** affects a console created if the **CREATE\_NEW\_CONSOLE** flag is specified.</span></span> <span data-ttu-id="78f45-126">Cela affecte également une console créée si le processus enfant utilise ensuite [**AllocConsole**](allocconsole.md).</span><span class="sxs-lookup"><span data-stu-id="78f45-126">It also affects a console created if the child process subsequently uses [**AllocConsole**](allocconsole.md).</span></span> <span data-ttu-id="78f45-127">Les caractéristiques de console suivantes peuvent être spécifiées :</span><span class="sxs-lookup"><span data-stu-id="78f45-127">The following console characteristics can be specified:</span></span>

- <span data-ttu-id="78f45-128">Taille de la nouvelle fenêtre de console, dans les cellules de caractères</span><span class="sxs-lookup"><span data-stu-id="78f45-128">Size of the new console window, in character cells</span></span>
- <span data-ttu-id="78f45-129">Emplacement de la nouvelle fenêtre de console, en coordonnées en pixels d’écran</span><span class="sxs-lookup"><span data-stu-id="78f45-129">Location of the new console window, in screen pixel coordinates</span></span>
- <span data-ttu-id="78f45-130">Taille de la mémoire tampon d’écran de la nouvelle console, dans les cellules de caractères</span><span class="sxs-lookup"><span data-stu-id="78f45-130">Size of the new console's screen buffer, in character cells</span></span>
- <span data-ttu-id="78f45-131">Attributs de couleur de texte et d’arrière-plan de la mémoire tampon d’écran de la nouvelle console</span><span class="sxs-lookup"><span data-stu-id="78f45-131">Text and background color attributes of the new console's screen buffer</span></span>
- <span data-ttu-id="78f45-132">Nom complet de la barre de titre de la fenêtre de la nouvelle console</span><span class="sxs-lookup"><span data-stu-id="78f45-132">Display name for the title bar of the new console's window</span></span>

<span data-ttu-id="78f45-133">Le système utilise les valeurs par défaut si les valeurs [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331) ne sont pas spécifiées.</span><span class="sxs-lookup"><span data-stu-id="78f45-133">The system uses default values if the [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331) values are not specified.</span></span> <span data-ttu-id="78f45-134">Un processus enfant peut utiliser la fonction [**GetStartupInfo**](https://msdn.microsoft.com/library/windows/desktop/ms683230) pour déterminer les valeurs dans sa structure **STARTUPINFO** .</span><span class="sxs-lookup"><span data-stu-id="78f45-134">A child process can use the [**GetStartupInfo**](https://msdn.microsoft.com/library/windows/desktop/ms683230) function to determine the values in its **STARTUPINFO** structure.</span></span>

<span data-ttu-id="78f45-135">Un processus ne peut pas modifier l’emplacement de sa fenêtre de console à l’écran, mais les fonctions de console suivantes sont disponibles pour définir ou récupérer les autres propriétés spécifiées dans la structure [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331) .</span><span class="sxs-lookup"><span data-stu-id="78f45-135">A process cannot change the location of its console window on the screen, but the following console functions are available to set or retrieve the other properties specified in the [**STARTUPINFO**](https://msdn.microsoft.com/library/windows/desktop/ms686331) structure.</span></span>

| <span data-ttu-id="78f45-136">Fonction</span><span class="sxs-lookup"><span data-stu-id="78f45-136">Function</span></span> | <span data-ttu-id="78f45-137">Description</span><span class="sxs-lookup"><span data-stu-id="78f45-137">Description</span></span> |
|-|-|
| [<span data-ttu-id="78f45-138">**GetConsoleScreenBufferInfo**</span><span class="sxs-lookup"><span data-stu-id="78f45-138">**GetConsoleScreenBufferInfo**</span></span>](getconsolescreenbufferinfo.md) | <span data-ttu-id="78f45-139">Récupère la taille de la fenêtre, la taille de la mémoire tampon d’écran et les attributs de couleur.</span><span class="sxs-lookup"><span data-stu-id="78f45-139">Retrieves the window size, screen buffer size, and color attributes.</span></span> |
| [<span data-ttu-id="78f45-140">**SetConsoleWindowInfo**</span><span class="sxs-lookup"><span data-stu-id="78f45-140">**SetConsoleWindowInfo**</span></span>](setconsolewindowinfo.md)  | <span data-ttu-id="78f45-141">Modifie la taille de la fenêtre de console.</span><span class="sxs-lookup"><span data-stu-id="78f45-141">Changes the size of the console window.</span></span>  |
| [<span data-ttu-id="78f45-142">**SetConsoleScreenBufferSize**</span><span class="sxs-lookup"><span data-stu-id="78f45-142">**SetConsoleScreenBufferSize**</span></span>](setconsolescreenbuffersize.md) | <span data-ttu-id="78f45-143">Modifie la taille de la mémoire tampon d’écran de la console.</span><span class="sxs-lookup"><span data-stu-id="78f45-143">Changes the size of the console screen buffer.</span></span> |
| [<span data-ttu-id="78f45-144">**SetConsoleTextAttribute**</span><span class="sxs-lookup"><span data-stu-id="78f45-144">**SetConsoleTextAttribute**</span></span>](setconsoletextattribute.md) | <span data-ttu-id="78f45-145">Définit les attributs de couleur.</span><span class="sxs-lookup"><span data-stu-id="78f45-145">Sets the color attributes.</span></span>  |
| [<span data-ttu-id="78f45-146">**SetConsoleTitle**</span><span class="sxs-lookup"><span data-stu-id="78f45-146">**SetConsoleTitle**</span></span>](setconsoletitle.md)  | <span data-ttu-id="78f45-147">Définit le titre de la fenêtre de console.</span><span class="sxs-lookup"><span data-stu-id="78f45-147">Sets the console window title.</span></span> |
| [<span data-ttu-id="78f45-148">**GetConsoleTitle**</span><span class="sxs-lookup"><span data-stu-id="78f45-148">**GetConsoleTitle**</span></span>](getconsoletitle.md)  | <span data-ttu-id="78f45-149">Récupère le titre de la fenêtre de console.</span><span class="sxs-lookup"><span data-stu-id="78f45-149">Retrieves the console window title.</span></span>  |

<span data-ttu-id="78f45-150">Un processus peut utiliser la fonction [**FreeConsole**](freeconsole.md) pour se détacher d’une console héritée ou d’une console créée par [**AllocConsole**](allocconsole.md).</span><span class="sxs-lookup"><span data-stu-id="78f45-150">A process can use the [**FreeConsole**](freeconsole.md) function to detach itself from an inherited console or from a console created by [**AllocConsole**](allocconsole.md).</span></span>

<span data-ttu-id="78f45-151">Un processus peut utiliser la fonction [**AttachConsole**](attachconsole.md) pour s’attacher à une autre session de console existante après l’utilisation de [**FreeConsole**](freeconsole.md) pour se détacher de sa propre session (ou s’il n’y a aucune session jointe).</span><span class="sxs-lookup"><span data-stu-id="78f45-151">A process can use the [**AttachConsole**](attachconsole.md) function to attach itself to another existing console session after using [**FreeConsole**](freeconsole.md) to detach from its own session (or if there is otherwise no attached session).</span></span>
